<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://datproject.org"

    >dat (v12.0.3)</a>
</h1>
<h4>Dat is the package manager for data. Easily share and version control data.</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.dat">module dat</a><ol>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">dat.</span>dat_json</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">dat.</span>doctor</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">dat.</span>index</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.dat.dat_json">module dat.dat_json</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.dat.dat_json.read">
            function <span class="apidocSignatureSpan">dat.dat_json.</span>read
            <span class="apidocSignatureSpan">(dat, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.dat.dat_json.write">
            function <span class="apidocSignatureSpan">dat.dat_json.</span>write
            <span class="apidocSignatureSpan">(dat, defaults, cb)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.dat.doctor">module dat.doctor</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.dat.doctor.command">
            function <span class="apidocSignatureSpan">dat.doctor.</span>command
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">dat.doctor.</span>options</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">dat.doctor.</span>help</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">dat.doctor.</span>name</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.dat.index">module dat.index</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.dat.index.bar">
            function <span class="apidocSignatureSpan">dat.index.</span>bar
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.dat.index.exit">
            function <span class="apidocSignatureSpan">dat.index.</span>exit
            <span class="apidocSignatureSpan">(log)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.dat.index.exitErr">
            function <span class="apidocSignatureSpan">dat.index.</span>exitErr
            <span class="apidocSignatureSpan">(err)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.dat.index.importProgress">
            function <span class="apidocSignatureSpan">dat.index.</span>importProgress
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.dat.index.link">
            function <span class="apidocSignatureSpan">dat.index.</span>link
            <span class="apidocSignatureSpan">(key)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.dat.index.network">
            function <span class="apidocSignatureSpan">dat.index.</span>network
            <span class="apidocSignatureSpan">(peers, stats)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.dat" id="apidoc.module.dat">module dat</a></h1>







</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.dat.dat_json" id="apidoc.module.dat.dat_json">module dat.dat_json</a></h1>


    <h2>
        <a href="#apidoc.element.dat.dat_json.read" id="apidoc.element.dat.dat_json.read">
        function <span class="apidocSignatureSpan">dat.dat_json.</span>read
        <span class="apidocSignatureSpan">(dat, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">read = function (dat, cb) {
  // dat.json
  // reads to dat.meta if exists
  // (TODO: move to module &#x26; validate dat.json)
  fs.readFile(datJsonFile(dat), &#x27;utf8&#x27;, function (err, body) {
    if (err) return cb(err)
    if (!body) return cb(null, {})
    var meta
    try {
      meta = JSON.parse(body)
    } catch (e) {
      return cb(new Error(&#x27;Error reading the dat.json file.&#x27;))
    }
    cb(null, meta)
  })
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// General Archive Info
output[0] = `Dat ${opts.live !== false ? &#x27;Archive&#x27; : &#x27;Snapshot Archive&#x27;} created: ${dat.path}`
if (dat.key) output[1] = ui.link(dat.key)
else output[1] = &#x27;Creating link...&#x27;
if (opts.quiet &#x26;&#x26; dat.key) process.stdout.write(ui.link(dat.key))

if (dat.owner) {
  datJson.<span class="apidocCodeKeywordSpan">read</span>(dat, function (err, body) {
    if (!err) return importFiles() // TODO: if dat.json exists, then what?
    if (err.code === &#x27;ENOENT&#x27; || !body) {
      return datJson.write(dat, function (err) {
        if (err) return exit(err)
        importFiles()
      })
    }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.dat.dat_json.write" id="apidoc.element.dat.dat_json.write">
        function <span class="apidocSignatureSpan">dat.dat_json.</span>write
        <span class="apidocSignatureSpan">(dat, defaults, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">write = function (dat, defaults, cb) {
  if (typeof defaults === &#x27;function&#x27;) {
    cb = defaults
    defaults = {}
  }
  dat.meta = {
    title: defaults.title || path.basename(dat.path),
    url: defaults.url,
    name: defaults.name,
    description: defaults.description || &#x27;&#x27;
  }
  if (dat.key) dat.meta.url = &#x27;dat://&#x27; + stringKey(dat.key)
  fs.writeFile(datJsonFile(dat), JSON.stringify(dat.meta), cb)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// TODO: could be optimized for frequent metadata updates
archive.metadata.on(&#x27;update&#x27;, updateDownload)

// General Archive Info
var niceType = (type === &#x27;clone&#x27;) ? &#x27;Cloning&#x27; : type.charAt(0).toUpperCase() + type.slice(1) + &#x27;ing&#x27
;
progressOutput[0] = `${niceType} Dat Archive: ${dat.path}`
progressOutput[1] = ui.link(dat.key) + &#x27;\n&#x27;
if (opts.quiet &#x26;&#x26; type !== &#x27;clone&#x27;) process.stdout.<span class="apidocCodeKeywordSpan">write</span>(ui.link(
dat.key))

// Stats
stats = dat.trackStats()
stats.on(&#x27;update:blocksProgress&#x27;, checkDone)

// Network
if (!opts.upload &#x26;&#x26; type !== &#x27;sync&#x27;) opts.upload = false // Do not upload on pull/clone
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.dat.doctor" id="apidoc.module.dat.doctor">module dat.doctor</a></h1>


    <h2>
        <a href="#apidoc.element.dat.doctor.command" id="apidoc.element.dat.doctor.command">
        function <span class="apidocSignatureSpan">dat.doctor.</span>command
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">command = function (opts) {
  opts.id = opts._[0]
  doctor(opts)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    opts.dir = opts._[0]
    fs.stat(opts.dir, function (err, stat) {
      if (err || !stat.isDirectory()) return usage(opts)

      // Set default opts. TODO: use default opts in sync
      opts.watch = opts.watch || true
      opts.import = opts.import || true
      require(&#x27;../lib/commands/sync&#x27;).<span class="apidocCodeKeywordSpan">command</span>(opts)
    })
  } catch (e) { return done() }
}

function done () {
  return usage(opts)
}
...</pre></li>
    </ul>








</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.dat.index" id="apidoc.module.dat.index">module dat.index</a></h1>


    <h2>
        <a href="#apidoc.element.dat.index.bar" id="apidoc.element.dat.index.bar">
        function <span class="apidocSignatureSpan">dat.index.</span>bar
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">bar = function () {
  return progress({
    width: 50,
    total: 100,
    style: function (complete, incomplete) {
      return &#x27;[&#x27; + complete + &#x27;&#x3e;&#x27; + incomplete + &#x27;]&#x27;
    }
  })
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  ],
  [] // Shows network information
]
var progressOutput = output[0] // shortcut for progress output
var log = logger(output, {debug: opts.verbose, quiet: opts.quiet || opts.debug}) // If debug=true we want output to be quiet

// UI Elements
var bar = ui.<span class="apidocCodeKeywordSpan">bar</span>()
var exit = ui.exit(log)

// Printing Things!!
if (opts.debug) opts.logspeed = 1000
setInterval(function () {
  if (stats) updateDownload()
  if (network) updateNetwork()
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.dat.index.exit" id="apidoc.element.dat.index.exit">
        function <span class="apidocSignatureSpan">dat.index.</span>exit
        <span class="apidocSignatureSpan">(log)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">exit = function (log) {
  return function (err) {
    if (err) {
      readline.cursorTo(process.stdout, 0)
      readline.clearLine(process.stdout)
      if (debug.enabled) console.trace(err)
      else console.error(err)
      process.exit(1)
    }
    if (log) log.print()
    process.exit(0)
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
module.exports = function (type, opts, dat) {
assert.ok(type, &#x27;lib/download download type required&#x27;)
assert.ok([&#x27;sync&#x27;, &#x27;clone&#x27;, &#x27;pull&#x27;].indexOf(type) &#x3e; -1, &#x27;lib/download download type must
 be sync, clone, pull&#x27;)

// TODO: clean up this logic
var resume = opts.resume || false
var hasKey = (dat &#x26;&#x26; dat.key) || opts.key
if (!hasKey &#x26;&#x26; !resume) return ui.<span class="apidocCodeKeywordSpan">exit</span>()(&#x27;lib/download Key required to
 download&#x27;)

var network = null
var stats = null
var archive = null
var onceConnected = false

// Logging Init
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.dat.index.exitErr" id="apidoc.element.dat.index.exitErr">
        function <span class="apidocSignatureSpan">dat.index.</span>exitErr
        <span class="apidocSignatureSpan">(err)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">exitErr = function (err) {
  // shortcut
  require(&#x27;./exit&#x27;)()(err)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  name: &#x27;publish&#x27;,
  options: [],
  command: publish
}

function publish (opts) {
  var client = Registry(opts)
  if (!client.whoami().token) return ui.<span class="apidocCodeKeywordSpan">exitErr</span>(&#x27;Please login before publishing.&#
x27;)

  opts.createIfMissing = false // publish must always be a resumed archive
  Dat(opts.dir, opts, function (err, dat) {
if (err) return ui.exitErr(err)

datJson.read(dat, function (err, body) {
  if (err &#x26;&#x26; err.code !== &#x27;ENOENT&#x27;) return ui.exitErr(err)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.dat.index.importProgress" id="apidoc.element.dat.index.importProgress">
        function <span class="apidocSignatureSpan">dat.index.</span>importProgress
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">importProgress = function () {
  var bar = Bar()
  var start = Date.now()
  return function (importer) {
    if (!importer || !importer.bytesImported) return &#x27;&#x27;
    var importedBytes = importer.bytesImported
    var importedFiles = importer.fileCount - 1 // counted before import finishes so -1 TODO: fix?
    var speed = importer.bytesImported * 1000 / (Date.now() - start)
    var progress = Math.round(importedBytes * 100 / importer.countStats.bytes)
    return bar(progress) + ` ${importedFiles} of ${importer.countStats.files} ${importer.countStats.files === 1 ? &#x27;file&#x27; : &#x27;files
&#x27;}` + &#x27; (&#x27; + prettyBytes(speed) + &#x27;/s&#x27; + &#x27;)&#x27;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  output.push([&#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;], []) // progress bar, live file list
  liveProgressOutput = output[2]
  fileOutput = output[3]
}
var log = logger(output, {debug: opts.verbose, quiet: opts.quiet || opts.debug}) // If debug=true we want output to be quiet.

// UI Elements
var importUI = ui.<span class="apidocCodeKeywordSpan">importProgress</span>()
var exit = ui.exit(log)

// Printing Things!!
setInterval(function () {
  if (importStatus &#x26;&#x26; !importDone) updateImport()
  if (network) updateNetwork()
  log.print()
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.dat.index.link" id="apidoc.element.dat.index.link">
        function <span class="apidocSignatureSpan">dat.index.</span>link
        <span class="apidocSignatureSpan">(key)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">link = function (key) {
  return `Link: dat://${stringKey(key)}`
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
})
// TODO: could be optimized for frequent metadata updates
archive.metadata.on(&#x27;update&#x27;, updateDownload)

// General Archive Info
var niceType = (type === &#x27;clone&#x27;) ? &#x27;Cloning&#x27; : type.charAt(0).toUpperCase() + type.slice(1) + &#x27;ing&#x27
;
progressOutput[0] = `${niceType} Dat Archive: ${dat.path}`
progressOutput[1] = ui.<span class="apidocCodeKeywordSpan">link</span>(dat.key) + &#x27;\n&#x27;
if (opts.quiet &#x26;&#x26; type !== &#x27;clone&#x27;) process.stdout.write(ui.link(dat.key))

// Stats
stats = dat.trackStats()
stats.on(&#x27;update:blocksProgress&#x27;, checkDone)

// Network
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.dat.index.network" id="apidoc.element.dat.index.network">
        function <span class="apidocSignatureSpan">dat.index.</span>network
        <span class="apidocSignatureSpan">(peers, stats)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">network = function (peers, stats) {
  if (!peers) return [&#x27;Looking for connections in Dat Network...&#x27;]
  var msg = []
  msg.push(`${peers} ${peers === 1 ? &#x27;peer&#x27; : &#x27;peers&#x27;} on the Dat Network`)
  var spdMsg = &#x27;&#x27;
  if (stats.downloadSpeed) spdMsg += `Downloading: ${prettyBytes(stats.downloadSpeed)}/s` + &#x27;  &#x27;
  if (stats.uploadSpeed) spdMsg += `Uploading: ${prettyBytes(stats.uploadSpeed)}/s`
  msg.push(spdMsg)
  return msg
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  else progressOutput[4] = `Total size: ${st.filesTotal} ${st.filesTotal === 1 ? &#x27;file&#x27; : &#x27;files&#x27;} (${prettyBytes
(st.bytesTotal)})`

  if (metaProgress &#x3c; 100) debug(&#x27;Metadata Download Progress:&#x27;, metaProgress + &#x27;%&#x27;)
  if (contentProgress &#x3c; 100) debug(&#x27;Download Progress:&#x27;, contentProgress + &#x27;%&#x27;, contentBlocksProgress, &#
x27;blocks of&#x27;, st.blocksTotal)
}

function updateNetwork () {
  output[1] = ui.<span class="apidocCodeKeywordSpan">network</span>(network.connected, stats.network)
}

function checkDone () {
  if (!onceConnected || archive.metadata.blocksRemaining() !== 0) return false
  if (!archive.content || archive.content.blocksRemaining() !== 0) return false
  if (archive.metadata.blocks &#x3e; 1 &#x26;&#x26; !archive.content.blocks) return false // If metadata.blocks = 1, content feed
 is empty so finish
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
